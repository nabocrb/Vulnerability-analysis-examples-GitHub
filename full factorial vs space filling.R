# Vulnerability analysis review
# Full-factorial vs optimizes LHS
# Nathan Bonham
# October 2023

rm(list=ls())

library(here)
library(lhs)
library(ggplot2)
library(ggpubr)

circ_size=2
threshold=.65


set.seed(9)

n=64
inputs=lhs::improvedLHS(n, k=2)
i1=inputs[,1]
i2=inputs[,2]

sfd=data.frame(i1,i2)

space_filling=ggplot(data=sfd, aes(x=i1, y=i2), fill='black')+
  geom_point(size=circ_size, shape=19)+
  geom_hline(yintercept = threshold, linetype=1, linewidth=1)+
  theme_bw()+
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    axis.ticks = element_blank()
  )+
  ggtitle('Space-filling design')
space_filling

levels=sqrt(n)

i1=seq(0,1, length.out=levels)
i2=i1

ffd=expand.grid(i1,i2)
colnames(ffd)=colnames(sfd)

full_factorial=ggplot(data=ffd, aes(x=i1, y=i2), fill='black')+
  geom_point(size=circ_size, shape=19)+
  geom_hline(yintercept = threshold, linetype=1, linewidth=1)+
  theme_bw()+
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    axis.ticks = element_blank()
  )+
  ggtitle('Full-factorial design')
full_factorial


plotlist=list(full_factorial, space_filling)

combined=ggarrange(plotlist = plotlist, common.legend = T, legend='right' )
combined

ggsave(here('figures', 'ffd vs sfd.tiff'), combined, device = 'tiff', width = 5.36, height = 2.92 , dpi=300, bg = 'white')
